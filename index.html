<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>–°–æ–∑–¥–∞—Ç—å –¥–æ–≥–æ–≤–æ—Ä</title>
<!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ docx -->
<script src="https://cdn.jsdelivr.net/npm/docx@7.4.0/build/index.min.js"></script>
<!-- –î–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–∞ -->
<script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
<style>
  body {
    font-family: 'Arial', sans-serif;
    background-color: #a4a3ff;
    padding: 20px;
    line-height: 1.6;
    color: #333;
  }
  h1 {
    color: #2c3e50;
    text-align: center;
    margin-bottom: 20px;
  }
  form {
    max-width: 900px;
    margin: 0 auto;
    background: #5dc1f0;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  }
  label {
    display: flex;
    flex-direction: column;
    margin-bottom: 15px;
    font-weight: 600;
  }
  input[type="text"],
  input[type="number"],
  input[type="date"],
  input[type="tel"],
  select {
    background-color: #ffc3a0;
    padding: 10px;
    font-size: 16px;
    border: 1px solid #ccc;
    border-radius: 4px;
    margin-top: 6px;
    transition: border-color 0.2s;
  }
  input[type="text"]:focus,
  input[type="number"]:focus,
  input[type="date"]:focus,
  input[type="tel"]:focus,
  select:focus {
    border-color: #3498db;
    outline: none;
  }
  h3 {
    margin-top: 20px;
    margin-bottom: 10px;
    color: #34495e;
  }
  button {
    background-color: #2980b9;
    color: #fff;
    border: none;
    padding: 12px 24px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 16px;
    transition: background-color 0.3s;
  }
  button:hover {
    background-color: #3498db;
  }
  #additionalItemForm {
    background: #f0f0f0;
    padding: 15px;
    border-radius: 8px;
    margin-top: 10px;
    display: none;
  }
  #itemsTable {
    width: 100%; /* –°–¥–µ–ª–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É —à–∏—Ä–∏–Ω–æ–π –≤—Å—é —à–∏—Ä–∏–Ω—É */
    border-collapse: collapse;
    margin-top: 10px;
  }
  #itemsTable th {
    background-color: #a2e91e;
    font-weight: 600;
  }
  #itemsTable th,
  #itemsTable td {
    padding: 10px;
    border: 1px solid #bdc3c7;
    text-align: center;
  }
  @media (max-width: 600px) {
    body { padding: 10px; }
    form { padding: 15px; }
    button { width: 100%; font-size: 18px; }
  }
  /* –°—Ç–∏–ª—å –¥–ª—è –æ–∫–Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
  #successMessage {
    display: none;
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background-color: #2ecc71;
    color: white;
    padding: 15px 30px;
    border-radius: 8px;
    font-size: 18px;
    z-index: 1000;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  }
</style>
</head>
<body>

<h1>–°–æ–∑–¥–∞—Ç—å –¥–æ–≥–æ–≤–æ—Ä</h1>
<form id="contractForm" onsubmit="return false;">
  <!-- –ü–æ–ª—è —Ñ–æ—Ä–º—ã -->
  <label>
    <p>–ú–∞—Ç–µ—Ä–∏–∞–ª:</p>
    <input type="text" id="serviceName" placeholder="–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏" />
  </label>
  <label>
    <p>–î–∞—Ç–∞:</p>
    <input type="date" id="date" />
  </label>
  <label>
    <p>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</p>
    <input type="number" id="quantity" min="0" />
  </label>
  <label>
    <p>–ï–¥:</p>
    <select id="unit">
      <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –µ–¥–∏–Ω–∏—Ü—É</option>
      <option value="—Ç">—Ç</option>
      <option value="–º3">–º3</option>
      <option value="—à—Ç">—à—Ç</option>
    </select>
  </label>
  <label>
    <p>–°—É–º–º–∞ (—Ä—É–±):</p>
    <input type="number" id="amount" min="0" />
  </label>
  <label>
    <p>–ò–º—è –∑–∞–∫–∞–∑—á–∏–∫–∞:</p>
    <input type="text" id="customer" placeholder="–ò–≤–∞–Ω–æ–≤ –ò –ò" />
  </label>
  <label>
    <p>–ê–¥—Ä–µ—Å:</p>
    <input type="text" id="address" placeholder="–ù–æ–≤–æ—Ç—Ä–∞–∫—Ç–æ–≤–∞—è, 157" />
  </label>
  <label>
    <p>–¢–µ–ª–µ—Ñ–æ–Ω –∑–∞–∫–∞–∑—á–∏–∫–∞:</p>
    <input type="tel" id="customerPhone" placeholder="8-(900)-000-00-00" />
  </label>

  <h3>–î–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∏—Ü–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤/—É—Å–ª—É–≥</h3>
  <button type="button" onclick="showAddItemForm()">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä/—É—Å–ª—É–≥—É</button>

  <div id="additionalItemForm">
    <label>
      <p>–ú–∞—Ç–µ—Ä–∏–∞–ª:</p>
      <input type="text" id="extraServiceName" placeholder="–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ" style="width:70%; display:inline-block;"/>
    </label>
    <label>
      <p>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</p>
      <input type="number" id="extraQuantity" min="0" style="width:70%; display:inline-block;"/>
    </label>
    <label>
      <p>–ï–¥:</p>
      <select id="extraUnit" style="width:70%; display:inline-block;">
        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –µ–¥–∏–Ω–∏—Ü—É</option>
        <option value="—Ç">—Ç</option>
        <option value="–º3">–º3</option>
        <option value="—à—Ç">—à—Ç</option>
      </select>
    </label>
    <label>
      <p>–°—É–º–º–∞:</p>
      <input type="number" id="extraAmount" min="0" style="width:70%; display:inline-block;"/>
    </label>
    <button type="button" onclick="addItem()">–î–æ–±–∞–≤–∏—Ç—å</button>
  </div>

  <div style="overflow-x:auto;">
    <table id="itemsTable">
      <thead>
        <tr>
          <th>‚Ññ</th>
          <th>–ú–∞—Ç–µ—Ä–∏–∞–ª</th>
          <th>–ö–æ–ª-–≤–æ</th>
          <th>–ï–¥</th>
          <th>–°—É–º–º–∞, —Ä—É–±.</th>
          <th>—É–¥–∞–ª</th>
        </tr>
      </thead>
      <tbody id="itemsBody"></tbody>
    </table>
  </div>

  <label style="margin-top:15px; display:flex; align-items:center; justify-content:space-around;">
    <input type="checkbox" id="discountCheckbox" />
    <span style="margin-left:8px;">5% —Å–∫–∏–¥–∫–∞ –ø—Ä–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ –∫–∞—Ä—Ç—ã ‚Ññ</span>
  </label>

  <button type="button" style="margin-top:20px;" onclick="createWord()">–°–æ–∑–¥–∞—Ç—å –¥–æ–≥–æ–≤–æ—Ä</button>
</form>

<!-- –û–∫–Ω–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–µ -->
<div id="successMessage">–§–æ—Ä–º–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!</div>

<script>
const { Document, Packer, Paragraph, TextRun, Table, TableRow, TableCell } = window.docx;

let items = [];

// –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ localStorage –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
window.addEventListener('load', () => {
  loadFormData();
});

// –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã –≤ localStorage –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
const formFields = [
  'serviceName',
  'date',
  'quantity',
  'unit',
  'amount',
  'customer',
  'address',
  'customerPhone',
  'discountCheckbox'
];

formFields.forEach(id => {
  const element = document.getElementById(id);
  if (element) {
    element.addEventListener('input', saveFormData);
    if (element.type === 'checkbox') {
      element.addEventListener('change', saveFormData);
    }
  }
});

// –¢–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
document.getElementById('extraServiceName').addEventListener('input', saveFormData);
document.getElementById('extraQuantity').addEventListener('input', saveFormData);
document.getElementById('extraUnit').addEventListener('change', saveFormData);
document.getElementById('extraAmount').addEventListener('input', saveFormData);

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã
function saveFormData() {
  const data = {};
  formFields.forEach(id => {
    const el = document.getElementById(id);
    if (el) {
      if (el.type === 'checkbox') {
        data[id] = el.checked;
      } else {
        data[id] = el.value;
      }
    }
  });
  // –¢–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º items
  data.items = items;
  localStorage.setItem('contractFormData', JSON.stringify(data));
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ localStorage
function loadFormData() {
  const dataStr = localStorage.getItem('contractFormData');
  if (dataStr) {
    try {
      const data = JSON.parse(dataStr);
      // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
      formFields.forEach(id => {
        const el = document.getElementById(id);
        if (el && data[id] !== undefined) {
          if (el.type === 'checkbox') {
            el.checked = data[id];
          } else {
            el.value = data[id];
          }
        }
      });
      // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ items
      if (data.items && Array.isArray(data.items)) {
        items = data.items;
        renderItems();
      }
    } catch (e) {
      console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã:', e);
    }
  }
}

function showAddItemForm() {
  document.getElementById('additionalItemForm').style.display = 'block';
}

function addItem() {
  const material = document.getElementById('extraServiceName').value.trim();
  const qtyStr = document.getElementById('extraQuantity').value.trim();
  const qty = parseFloat(qtyStr);
  const unit = document.getElementById('extraUnit').value;
  const amountStr = document.getElementById('extraAmount').value.trim();
  const amount = parseFloat(amountStr);

  if (!material && isNaN(qty) && isNaN(amount)) {
    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ –ø–æ–ª–µ —Ç–æ–≤–∞—Ä–∞/—É—Å–ª—É–≥–∏');
    return;
  }

  if (material && (isNaN(qty) || isNaN(amount) || !unit)) {
    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è —Ç–æ–≤–∞—Ä–∞/—É—Å–ª—É–≥–∏ –∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –∏—Ö –ø—É—Å—Ç—ã–º–∏');
    return;
  }

  if (material || !isNaN(qty) || !isNaN(amount)) {
    items.push({ material, qty, unit, amount });
  } else {
    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è —Ç–æ–≤–∞—Ä–∞/—É—Å–ª—É–≥–∏');
    return;
  }

  renderItems();
  saveFormData();

  document.getElementById('extraServiceName').value = '';
  document.getElementById('extraQuantity').value = '';
  document.getElementById('extraAmount').value = '';
  document.getElementById('additionalItemForm').style.display = 'none';
}

function renderItems() {
  const tbody = document.getElementById('itemsBody');
  tbody.innerHTML = '';
  items.forEach((item, index) => {
    const row = document.createElement('tr');
    row.innerHTML = `
      <td>${index + 1}</td>
      <td>${item.material}</td>
      <td>${item.qty}</td>
      <td>${item.unit}</td>
      <td>${item.amount.toFixed(2)}</td>
      <td><button type="button" onclick="removeItem(${index})" style="background:#e74c3c; color:#fff; border:none; padding:5px 10px; border-radius:4px; cursor:pointer;">–£–¥–∞–ª–∏—Ç—å</button></td>
    `;
    tbody.appendChild(row);
  });
}

function removeItem(index) {
  items.splice(index, 1);
  renderItems();
  saveFormData();
}

function createDashedLine() {
  // –£–±–∏—Ä–∞–µ–º —à—Ç—Ä–∏—Ö–ø—É–Ω–∫—Ç–∏—Ä–Ω—É—é –ª–∏–Ω–∏—é, –æ—Å—Ç–∞–≤–ª—è–µ–º –ø—É—Å—Ç–æ–π –ø–∞—Ä–∞–≥—Ä–∞—Ñ
  return new Paragraph({});
}

function createWord() {
  const serviceName = document.getElementById('serviceName').value.trim();
  const dateStr = document.getElementById('date').value;
  const quantityStr = document.getElementById('quantity').value.trim();
  const quantity = quantityStr ? parseFloat(quantityStr) : 0;
  const unit = document.getElementById('unit').value;
  const amountStr = document.getElementById('amount').value.trim();
  const amount = amountStr ? parseFloat(amountStr) : 0;
  const customer = document.getElementById('customer').value.trim();
  const address = document.getElementById('address').value.trim();
  const customerPhone = document.getElementById('customerPhone').value.trim();
  const discount = document.getElementById('discountCheckbox').checked;

  if (
    !dateStr && items.length === 0 && !serviceName && !customer && !address && !customerPhone
  ) {
    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∏–∑ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –ø–æ–∑–∏—Ü–∏–∏.');
    return;
  }

  const dateObj = dateStr ? new Date(dateStr) : new Date();
  const day = dateObj.getDate();
  const monthLong = dateObj.toLocaleString('ru', { month: 'long' });
  const year = dateObj.getFullYear();

  let totalAmount = 0;

  const tableRows = [];

  // –ü–æ–∑–∏—Ü–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤/—É—Å–ª—É–≥
  items.forEach((item, index) => {
    if (item.material && item.qty && item.unit && item.amount) {
      tableRows.push({ number: index + 1, material: item.material, qty: item.qty, unit: item.unit, amount: item.amount });
      totalAmount += item.amount;
    }
  });

  // –û—Å–Ω–æ–≤–Ω–æ–π —Ç–æ–≤–∞—Ä/—É—Å–ª—É–≥–∞
  if (serviceName && (quantity || amount)) {
    tableRows.push({ number: items.length + 1, material: serviceName, qty: quantity, unit: unit, amount: amount });
    totalAmount += amount;
  }

  const discountAmount = discount ? totalAmount * 0.05 : 0;
  const totalWithDiscount = totalAmount - discountAmount;

  const section1 = createContractSection({ tableRows, totalAmount, totalWithDiscount, discount, discountAmount, customer, address, customerPhone, dateStr });
  const section2 = createContractSection({ tableRows, totalAmount, totalWithDiscount, discount, discountAmount, customer, address, customerPhone, dateStr });

  const doc = new Document({
    sections: [
      {
        children: [
          section1,
          createDashedLine(),
          section2,
        ],
      },
    ],
  });

  Packer.toBlob(doc).then(blob => {
    saveAs(blob, "–¥–æ–≥–æ–≤–æ—Ä.docx");
    showSuccessMessage();
  });
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–µ
function showSuccessMessage() {
  const msgDiv = document.getElementById('successMessage');
  msgDiv.style.display = 'block';
  setTimeout(() => {
    msgDiv.style.display = 'none';
  }, 3000);
}

function createContractSection({ tableRows, totalAmount, totalWithDiscount, discount, discountAmount, customer, address, customerPhone, dateStr }) {
  const dateObj = dateStr ? new Date(dateStr) : new Date();
  const day = dateObj.getDate();
  const monthLong = dateObj.toLocaleString('ru', { month: 'long' });
  const year = dateObj.getFullYear();

  const table = createTable(tableRows);

  const sumText = new Paragraph({
    children: [new TextRun({ text: `–û–±—â–∞—è —Å—É–º–º–∞: ${totalAmount.toFixed(2)} —Ä—É–±.`, size: 25 })]
  });
  const discountText = discount ? new Paragraph({ children: [new TextRun({ text: `–°–∫–∏–¥–∫–∞ 5%: -${discountAmount.toFixed(2)} —Ä—É–±.`, size: 25 })] }) : null;
  const totalWithDiscountText = new Paragraph({ children: [new TextRun({ text: `–ò—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞: ${totalWithDiscount.toFixed(2)} —Ä—É–±.`, size: 25 })] });
  
  return new Paragraph({
    children: [
      new TextRun({ text: '       ‚òé 8 342 246 12 09  üåê–°–∞–º–æ—Å–≤–∞–ª—å—â–∏–∫.–†–§                        ‚òé 8 342 271 81 41\n  ‚úâ Samosvalchikf@gmail.com\n', break: 0, size: 18 }),
      new TextRun({ text: `                                       –ê–ö–¢ ‚Ññ 1 –û–¢ ${day} ${monthLong} ${year} –≥.`, bold: true, break: 2 , size: 25 }),
      new TextRun({ text: '–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –ò–ü –ú–∏—Ö–∞–π–ª–æ–≤ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ê–Ω–¥—Ä–µ–µ–≤–∏—á\n', break: 1 , size: 24}),
      new TextRun({ text: '–ò–ù–ù 590613985887 –û–ì–†–ù–ò–ü 305590609000010 —Ç–µ–ª.271-81-41', break: 1 , size: 24 }),
       new TextRun({ text: ' '.repeat(50) }),
      new TextRun({ text: `                     –ó–∞–∫–∞–∑—á–∏–∫: ${customer}, –ê–¥—Ä–µ—Å: ${address}, –¢–µ–ª–µ—Ñ–æ–Ω: ${customerPhone}`, size: 20, bold: true }),
      new Paragraph({ text: "" }),
      table,
      sumText,
      ...(discount ? [discountText] : []),
      totalWithDiscountText,
      new Paragraph({ text: "", break: 2 }),
      new Paragraph({ 
        children: [
          new TextRun({ text: '–í—ã—à–µ–ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏ –≤ —Å—Ä–æ–∫. –ó–∞–∫–∞–∑—á–∏–∫ –ø—Ä–µ—Ç–µ–Ω–∑–∏–π –ø–æ –æ–±—ä–µ–º—É, –∫–∞—á–µ—Å—Ç–≤—É –∏ —Å—Ä–æ–∫–∞–º –æ–∫–∞–∑–∞–Ω–∏—è —É—Å–ª—É–≥ –Ω–µ –∏–º–µ–µ—Ç.', size: 24 }),
        ],
      }),
      new Paragraph({ text: "" }),
      new Paragraph({
        children: [
          new TextRun({ text: '–í–û–î–ò–¢–ï–õ–¨ _______________________________    ___________________________________________', break: 0, bold: true }),
          new TextRun({ text: ' '.repeat(50) }),
          new TextRun({ text: '–ò–°–ü–û–õ–ù–ò–¢–ï–õ–¨                                                                                                 –ó–ê–ö–ê–ó–ß–ò–ö  ', bold: true }),
        ],
      }),
      new Paragraph({ children: [new TextRun({ text: "–õ–û–ì–ò–°–¢", bold: true, })], }),
      new Paragraph({ text: "" }),
      new Paragraph({ 
        children: [
          new TextRun({ text: '*–ü—Ä–æ—Å–∏–º –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å:', size: 22, bold: true }),
        ],
      }),
      new Paragraph({ children: [new TextRun({ text: '–û—Ç–∫—É–¥–∞ —É–∑–Ω–∞–ª–∏ –æ –Ω–∞—à–µ–π –∫–æ–º–ø–∞–Ω–∏–∏?__________________________________________________', size: 22 })] }),
      new Paragraph({ 
        children: [
          new TextRun({ text: '     –ü–µ—Ä–µ–≤–æ–¥ 8-908-271-81-41 –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ê–Ω–¥—Ä–µ–µ–≤–∏—á –ú.(–°–±–µ—Ä–±–∞–Ω–∫)', bold: true, size: 28, break: 2 }),
        ],
        break: 2,
      }),
    ],
  });
}

function createTable(rowsData) {
  const rows = [];

  // –ó–∞–≥–æ–ª–æ–≤–∫–∏
  rows.push(
    new TableRow({
      children: [
        new TableCell({ children: [new Paragraph({ children: [new TextRun({ text: '‚Ññ', bold: true, size: 20 })] })], width: { size: 10, type: 'pct' } }),
        new TableCell({ children: [new Paragraph({ children: [new TextRun({ text: '–ú–∞—Ç–µ—Ä–∏–∞–ª', bold: true, size: 20 })] })], width: { size: 20, type: 'pct' } }),
        new TableCell({ children: [new Paragraph({ children: [new TextRun({ text: '–ö–æ–ª-–≤–æ', bold: true, size: 20 })] })], width: { size: 15, type: 'pct' } }),
        new TableCell({ children: [new Paragraph({ children: [new TextRun({ text: '–ï–¥', bold: true, size: 20 })] })], width: { size: 15, type: 'pct' } }),
        new TableCell({ children: [new Paragraph({ children: [new TextRun({ text: '–°—É–º–º–∞', bold: true, size: 20 })] })], width: { size: 20, type: 'pct' } }),
      ],
    })
  );

  // –§–∏–ª—å—Ç—Ä –ø–æ–∑–∏—Ü–∏–π, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å –Ω–æ–º–µ—Ä
  const filteredRows = rowsData.filter(r => r.number);

  // –°—Ç—Ä–æ–∫–∏ –ø–æ–∑–∏—Ü–∏–π
  for (const row of filteredRows) {
    rows.push(
      new TableRow({
        children: [
          new TableCell({ children: [new Paragraph({ children: [new TextRun({ text: row.number.toString(), size: 20 })] })], width: { size: 10, type: 'pct' } }),
          new TableCell({ children: [new Paragraph({ children: [new TextRun({ text: row.material, size: 20 })] })], width: { size: 20, type: 'pct' } }),
          new TableCell({ children: [new Paragraph({ children: [new TextRun({ text: row.qty, size: 20 })] })], width: { size: 15, type: 'pct' } }),
          new TableCell({ children: [new Paragraph({ children: [new TextRun({ text: row.unit, size: 20 })] })], width: { size: 15, type: 'pct' } }),
          new TableCell({ children: [new Paragraph({ children: [new TextRun({ text: row.amount.toFixed(2), size: 20 })] })], width: { size: 20, type: 'pct' } }),
        ],
      })
    );
  }

  return new Table({ rows, width: { size: '100%', type: 'pct' } });
}
</script>
</body>
</html>
